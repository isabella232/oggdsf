<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>liboggz: Using OggzMetric</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.5 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">Globals</a></div>
<h1>Using OggzMetric</h1><h2><a class="anchor" name="metric_intro">
Introduction</a></h2>
An OggzMetric is a helper function for Oggz's seeking mechanism.<p>
If every position in an Ogg stream can be described by a metric such as time, then it is possible to define a function that, given a serialno and granulepos, returns a measurement in units such as milliseconds. Oggz will use this function repeatedly while seeking in order to navigate through the Ogg stream.<p>
The meaning of the units is arbitrary, but must be consistent across all logical bitstreams. This allows Oggz to seek accurately through Ogg bitstreams containing multiple logical bitstreams such as tracks of media.<h2><a class="anchor" name="setting">
How to set metrics</a></h2>
You don't need to set metrics for Vorbis, Speex, Theora or Annodex. These can be handled <a class="el" href="group__auto.html">automatically </a> by Oggz.<p>
For most others it is simply a matter of providing a linear multiplication factor (such as a sampling rate, if each packet's granulepos represents a sample number). For non-linear data streams, you will need to explicitly provide your own OggzMetric function.<h3><a class="anchor" name="linear">
Linear Metrics</a></h3>
<ul>
<li>Set the <em>granule_rate_numerator</em> and <em>granule_rate_denominator</em> appropriately using <a class="el" href="group__seek__api.html#ga1">oggz_set_metric_linear()</a></li></ul>
<h3><a class="anchor" name="custom">
Custom Metrics</a></h3>
For streams with non-linear granulepos, you need to set a custom metric:<p>
<ul>
<li>Implement an OggzMetric callback</li><li>Set the OggzMetric callback using <a class="el" href="group__seek__api.html#ga2">oggz_set_metric()</a></li></ul>
<h2><a class="anchor" name="using">
Seeking with OggzMetrics</a></h2>
To seek, use <a class="el" href="group__seek__api.html#ga4">oggz_seek_units()</a>. Oggz will perform a ratio search through the Ogg bitstream, using the OggzMetric callback to determine its position relative to the desired unit.<p>
<dl compact><dt><b>Note:</b></dt><dd></dd></dl>
Many data streams begin with headers describing such things as codec setup parameters. One of the assumptions Monty makes is:<p>
<ul>
<li>Given pre-cached decode headers, a player may seek into a stream at any point and begin decode.</li></ul>
<p>
Thus, the first action taken by applications dealing with such data is to read in and cache the decode headers; thereafter the application can safely seek to arbitrary points in the data.<p>
This impacts seeking because the portion of the bitstream containing decode headers should not be considered part of the metric space. To inform Oggz not to seek earlier than the end of the decode headers, use <a class="el" href="group__seek__api.html#ga6">oggz_set_data_start()</a>. 
<p>
<table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Fri May 21 16:55:01 2004 for liboggz by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.5 </small></address>
</body>
</html>
